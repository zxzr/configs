"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(){_classCallCheck(this,a),this.handlers={}}return _createClass(a,[{key:"_addEventListener",value:function(a,b){(this.handlers[a]||(this.handlers[a]=[])).push(b)}},{key:"fire",value:function(a,b){if(this.handlers[a])for(var c=this.handlers[a],d=c.length,e=0;d>e;e++){var f=c[e];f&&f(b)}}},{key:"on",value:function(a,b){var c=Object.prototype.toString.call(a);if("[object String]"==c)this._addEventListener(a,b);else if("[object Array]"==c)for(var d=0,e=a.length;e>d;d++)this._addEventListener(a[d],b);else{if("[object Object]"!=c)throw Error("arguments error");for(var f in a)a.hasOwnProperty(f)&&this._addEventListener(f,a[f])}}},{key:"un",value:function(a,b){this.handlers[a]&&this.handlers[name].filer(function(a){return a!=b})}}]),a}(),b=new(function(){function b(){_classCallCheck(this,b),this._contentEventManager=null,this._extensionEventManger=null}return _createClass(b,[{key:"extensionEventManger",get:function(){return this._extensionEventManger},set:function(a){this._extensionEventManger=a}},{key:"contentEventManager",set:function(a){this._contentEventManager=a},get:function(){return this._contentEventManager}}]),_createClass(b,[{key:"_addContentLister",value:function(){var b=this;this.contentEventManager=new a,chrome.extension.onMessage.addListener(function(a,c,d){var e=a.type,f=a.data;b.contentEventManager&&b.contentEventManager.fire(e,{data:f,resp:d})})}},{key:"_addExtensionLister",value:function(){this.extensionEventManger=new a}},{key:"sendToExtension",value:function(a,b,c){chrome.extension.sendMessage({type:a,data:b},c)}},{key:"sendToContent",value:function(a,b,c,d){chrome.tabs.sendMessage(a,{type:b,data:c},d)}},{key:"addContentLister",value:function(a,b){this.contentEventManager||this._addContentLister(),this.contentEventManager.on(a,b)}},{key:"addExtensionLister",value:function(a,b){this.extensionEventManger||this._addExtensionLister(),this.extensionEventManger.on(a,b)}}]),b}()),c=new(function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"ready",value:function b(a){var b=!1,c=function(){b||(b=!0,a())};"complete"==document.readyState?a():(this.addListener(window,"DOMContentLoaded",c),this.addListener(window,"load",c))}},{key:"getAttr",value:function(a,b){return a.getAttribute(b)}},{key:"setStyles",value:function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a.style[c]=b[c])}},{key:"show",value:function(a,b){"[object array]"!=Object.prototype.toString.call(a).toLowerCase()&&(a=[a]);for(var c=0;c<a.length;c++)this.setStyles(a[c],{display:b||"block"})}},{key:"hide",value:function(a,b){"[object array]"!=Object.prototype.toString.call(a).toLowerCase()&&(a=[a]);for(var c=0;c<a.length;c++)this.setStyles(a[c],{display:b||"none"})}},{key:"findParent",value:function(a,b){for(var c=a.parentNode;c!=document.body&&-1===(c.className||"").indexOf(b);)c=c.parentNode;return c}},{key:"queryAll",value:function(a){return document.querySelectorAll(a)}},{key:"query",value:function(a,b){return b=b||document,b.querySelector(a)}},{key:"html",value:function(a){return a.innerHTML}},{key:"setText",value:function(a,b){a.innerText=b}},{key:"addListener",value:function(a,b,c){a.addEventListener(b,c)}}]),a}());c.ready(function(){function a(a){a=isNaN(a)?0:a,a=a>99?"99+":a,c.setText(e,a)}var d=chrome.extension.getURL("option.html"),e=c.query(".count"),f=c.query(".btn-setting"),g=c.query(".btn-disable");document.oncontextmenu=function(a){return a.stopPropagation(),!1},c.addListener(f,"click",function(a){a.preventDefault(),b.sendToExtension("openUrl",d,function(){window.close()}),setTimeout(function(){window.close()},500)}),c.addListener(g,"click",function(a){a.preventDefault(),chrome.tabs.getSelected(null,function(a){b.sendToExtension("addWhite",a,function(){window.close()}),setTimeout(function(){window.close()},500)})}),chrome.tabs.getSelected(null,function(c){b.sendToExtension("getBadgeText",c.id,function(b){a(b)})}),chrome.extension.onMessage.addListener(function(b,c,d){var e=b.type,f=b.data;switch(e){case"onBlockedCountChanged":chrome.tabs.getSelected(null,function(b){b.id==f.tabId&&a(f.count)})}return!0})})}();